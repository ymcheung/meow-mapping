---
import { getCollection, getEntry, render } from 'astro:content';
import Layout from '@layouts/Page.astro';
import Figure from './_components/Figure.astro';
// import { locales } from '@i18n/i18n';
// import { getLocaleFromUrl} from '@i18n/utilities';

export async function getStaticPaths() {
  const posts = await getCollection('posts');
  return posts.map((post) => {
    const { id, data } = post;

    return ({
      params: {
        category: data.category,
        blogPost: id
      },
      props: {
        ...data
      }
    })
  });
}

const { blogPost } = Astro.params
const { title, description, hasCover, category, difficulty, feed, dateVisited, dateModified, datePublished } = Astro.props;

console.log(Astro.props)

const post = await getEntry('posts', blogPost);
if (!post) return;

const { Content } = await render(post);

---

<Layout
  title={title}
  description={description}
  hasCover={hasCover}
  difficulty={difficulty}
  feed={feed}
  category={category}
  dateVisited={dateVisited}
  dateModified={dateModified}
  datePublished={datePublished}
>
  <Content
    components={{
      img: Figure
    }}
  />
</Layout>
